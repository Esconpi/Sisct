<table class="table" style="font-size:12px; border:2px solid;">
    <thead>
        <tr>
            <th style="border:1px solid;">

            </th>
            <th style="text-align:center; border:1px solid;">
                Total
            </th>
            <th style="text-align:center; border:1px solid;">
                Devolução
            </th>
            <th style="text-align:center; border:1px solid;">
                Base de Cálculo
            </th>
            <th style="text-align:center; border:1px solid;">
                Percentual (%)
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th style="border: 1px solid; text-align:center;">
                Vendas
            </th>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalVenda)
            </td>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalDevo)
            </td>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.BaseCalc)
            </th>
            <th style="text-align:right; padding-right:1%; border:1px solid;"></th>
        </tr>
        <tr>
            <th style="border: 1px solid; text-align:center;">
                Vendas P/ Contribuintes
            </th>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.Contribuinte)
            </td>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalDevoContribuite)
            </td>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.BaseCalcContribuinte)
            </th>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.PercentualVendaContribuinte) %
            </th>
        </tr>
        <tr>
            <th style="border: 1px solid; text-align:center;">
                Vendas P/ Não Contribuintes
            </th>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.NContribuinte)
            </td>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalDevoNContribuinte)
            </td>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.BaseCalcNContribuinte)
            </th>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.PercentualVendaNContribuinte) %
            </th>
        </tr>
        @if (ViewBag.Company.AnnexId == 1 || ViewBag.Company.ChapterId == 4)
        {
            @if (ViewBag.Company.ChapterId == 4)
             {
                <tr>
                    <th style="border: 1px solid; text-align:center;">
                        Vendas do Inciso I
                    </th>
                    <td style="text-align:right; padding-right:1%; border:1px solid;">
                        @string.Format("{0:N}", ViewBag.VendasIncisoI)
                    </td>
                    <td style="text-align:right; padding-right:1%; border:1px solid;">
                        @string.Format("{0:N}", ViewBag.TotalDevoIncisoI)
                    </td>
                    <th style="text-align:right; padding-right:1%; border:1px solid;">
                        @string.Format("{0:N}", ViewBag.BaseCalcIncisoI)
                    </th>
                    <th style="text-align:right; padding-right:1%; border:1px solid;">
                        @string.Format("{0:N}", ViewBag.PercentualVendaIncisoI) %
                    </th>
                </tr>
                <tr>
                    <th style="border: 1px solid; text-align:center;">
                        Vendas do Inciso II
                    </th>
                    <td style="text-align:right; padding-right:1%; border:1px solid;">
                        @string.Format("{0:N}", ViewBag.VendasIncisoII)
                    </td>
                    <td style="text-align:right; padding-right:1%; border:1px solid;">
                        @string.Format("{0:N}", ViewBag.TotalDevoIncisoII)
                    </td>
                    <th style="text-align:right; padding-right:1%; border:1px solid;">
                        @string.Format("{0:N}", ViewBag.BaseCalcIncisoII)
                    </th>
                    <th style="text-align:right; padding-right:1%; border:1px solid;">
                        @string.Format("{0:N}", ViewBag.PercentualVendaIncisoII) %
                    </th>
                </tr>
            }
            <tr>
                @if (ViewBag.Company.ChapterId == 4)
                {
                    <th style="border: 1px solid; text-align:center;">
                        Vendas do Inciso I e II
                    </th>
                }
                @if (ViewBag.Company.AnnexId == 1)
                {
                    <th style="border: 1px solid; text-align:center;">
                        Vendas do Anexo II
                    </th>
                }

                <td style="text-align:right; padding-right:1%; border:1px solid;">
                    @string.Format("{0:N}", ViewBag.VendaNcm)
                </td>
                <td style="text-align:right; padding-right:1%; border:1px solid;">
                    @string.Format("{0:N}", ViewBag.TotalDevoNcm)
                </td>
                <th style="text-align:right; padding-right:1%; border:1px solid;">
                    @string.Format("{0:N}", ViewBag.BaseCalcNcm)
                </th>
                <th style="text-align:right; padding-right:1%; border:1px solid;">
                    @string.Format("{0:N}", ViewBag.PercentualVendaNcm) %
                </th>
            </tr>
        }

        <tr>
            <th style="border: 1px solid; text-align:center;">
                Vendas P/ mesmo grupo maior que @string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.VendaMGrupo)) %
            </th>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalVendaGrupo)
            </td>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalDevoGrupo)
            </td>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalBaseCalcuGrupo)
            </th>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.PercentualVendaGrupo) %
            </th>
        </tr>
    </tbody>
</table>


@if (ViewBag.Grupo.Count > 0)
{

    <table class="table" style="font-size: 12px; border:2px solid;">
        <thead>
            <tr style="border: 1px solid;">
                <th style="border: 1px solid; text-align:center;">CNPJ</th>
                <th style="border: 1px solid; text-align:center;">Cliente</th>
                <th style="border: 1px solid; text-align:center;">Base de Cálculo</th>
                <th style="border: 1px solid; text-align:center;">Percentual (%)</th>
            </tr>
        </thead>
        <tbody>

            @foreach (var item in ViewBag.Grupo)
            {
                <tr>
                    <td>@item[0]</td>
                    <td>@item[1]</td>
                    <td style="text-align:right;">@string.Format("{0:N}", Convert.ToDecimal(item[2]))</td>
                    <td style="text-align:right;">@string.Format("{0:N}", Convert.ToDecimal(item[3])) %</td>
                </tr>
            }

        </tbody>
    </table>
}

<div style="border:2px solid; text-align:center; page-break-before: always;">
    <strong>ICMS EXCEDENTE</strong>
</div>
<table class="table" style="font-size: 11px; border:2px solid;">
    <thead>
        <tr>
            <th style="width:200px;"></th>
            <th style="width:120px;">Vendas</th>
            <th></th>
            <th style="width:120px;">Limite (MÁXIMO)</th>
            <th></th>
            <th style="width:100px;">Excedente</th>
            <th></th>
            <th style="width:100px;">Adicional</th>
            <th></th>
            <th style="width:100px;">Total</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th>ICMS Excedente Grupo (@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.VendaMGrupo)) %)</th>
            <td style="text-align:right; padding-right:1%;">
                @string.Format("{0:N}", ViewBag.TotalBaseCalcuGrupo)
            </td>
            <th style="font-size:17px; text-align:center">-</th>
            <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.LimiteGrupo)</td>
            <th style="font-size:17px; text-align:center">=</th>
            <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.ExcedenteGrupo)</td>
            <th style="text-align:center">x</th>
            <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.VendaMGrupoExcedente)) %</td>
            <th style="font-size:17px; text-align:center" ">=</th>
            <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.TotalExcedenteGrupo)</td>
        </tr>
        @if (ViewBag.Company.ChapterId == 4)
        {
            <tr>
                <th>Transferência - Saída (@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.Transferencia)) %)</th>
                <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.TotalTransferencia)</td>
                <th style="font-size:17px; text-align:center">-</th>
                <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.LimiteTransferencia)</td>
                <th style="font-size:17px; text-align:center">=</th>
                <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.ExcedenteTransferencia)</td>
                <th style="text-align:center">x</th>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.TransferenciaExcedente)) %</td>
                <th style="font-size:17px; text-align:center">=</th>
                <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.TotalExcedenteTransferencia)</td>
            </tr>
        }
        @if (ViewBag.Company.ChapterId != 4)
        {
            <tr>
                <th>ICMS Excedente P/ Não Contribuinte (@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.VendaCpf)) %)</th>
                <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.BaseCalcNContribuinte)</td>
                <th style="font-size:17px; text-align:center">-</th>
                <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.LimiteNContribuinte)</td>
                <th style="font-size:17px; text-align:center">=</th>
                <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.ExcedenteNContribuinte)</td>
                <th style="text-align:center">x</th>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.VendaCpfExcedente)) %</td>
                <th style="font-size:17px; text-align:center">=</th>
                <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.TotalExcedenteNContribuinte)</td>
            </tr>
        }
        <tr>
            <th style="width:200px;">&nbsp;</th>
            <th style="width:120px;">&nbsp;</th>
            <th>&nbsp;</th>
            <th style="width:120px;">&nbsp;</th>
            <th></th>
            <th style="width:100px;">&nbsp;</th>
            <th>&nbsp;</th>
            <th style="width:100px;">&nbsp;</th>
            <th></th>
            <th style="width:100px;">&nbsp;</th>
        </tr>
        <tr>
            <th style="width:200px;"></th>
            <th style="width:120px;">Compras</th>
            <th></th>
            <th style="width:120px;">Limite (MÁXIMO)</th>
            <th></th>
            <th style="width:100px;">Excedente</th>
            <th></th>
            <th style="width:100px;">Adicional</th>
            <th></th>
            <th style="width:100px;">Total</th>
        </tr>
        <tr>
            <th>Transferência Interestadual - Entrada (@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.TransferenciaInter)) %)</th>
            <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.TotalTransferenciaInter)</td>
            <th style="font-size:17px; text-align:center">-</th>
            <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.LimiteTransferenciaInter)</td>
            <th style="font-size:17px; text-align:center">=</th>
            <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.ExcedenteTransferenciaInter)</td>
            <th style="text-align:center">x</th>
            <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.TransferenciaInterExcedente)) %</td>
            <th style="font-size:17px; text-align:center">=</th>
            <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.TotalExcedenteTransferenciaInter)</td>
        </tr>

        @if (ViewBag.Company.AnnexId == 1 || ViewBag.Company.ChapterId == 4)
        {
            <tr>
                <th style="width:200px;">&nbsp;</th>
                <th style="width:120px;">&nbsp;</th>
                <th>&nbsp;</th>
                <th style="width:120px;">&nbsp;</th>
                <th></th>
                <th style="width:100px;">&nbsp;</th>
                <th>&nbsp;</th>
                <th style="width:100px;">&nbsp;</th>
                <th></th>
                <th style="width:100px;">&nbsp;</th>
            </tr>

            <tr>
                <th style="width:200px;"></th>
                <th style="width:120px;">Limite (MÍNIMO)</th>
                <th></th>
                <th style="width:120px;">Vendas</th>
                <th></th>
                <th style="width:100px;">Excedente</th>
                <th></th>
                <th style="width:100px;">Adicional</th>
                <th></th>
                <th style="width:100px;">Total</th>
            </tr>

            <tr>
                @if (ViewBag.Company.AnnexId == 1)
                {
                    <tr>
                        <th>Venda Conforme Anexo II (@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.VendaAnexo)) %)</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.LimiteNcm)</td>
                        <th style="font-size:17px;text-align:center">-</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.BaseCalcNcm)</td>
                        <th style="font-size:17px;text-align:center">=</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.ExcedenteNcm)</td>
                        <th style="text-align:center">x</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.VendaAnexoExcedente)) %</td>
                        <th style="font-size:17px;text-align:center">=</th>
                        <td>@string.Format("{0:N}", ViewBag.TotalExcedenteNcm)</td>
                    </tr>
                }

                @if (ViewBag.Company.ChapterId == 4)
                {
                    <tr>
                        <th>ICMS Excedente P/ Contribuinte (@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.VendaContribuinte)) %)</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.LimiteContribuinte)</td>
                        <th style="font-size:17px;text-align:center">-</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.BaseCalcContribuinte)</td>
                        <th style="font-size:17px;text-align:center">=</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.ExcedenteContribuinte)</td>
                        <th style="text-align:center">x</th>
                        <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.VendaContribuinteExcedente)) %</td>
                        <th style="font-size:17px;text-align:center">=</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.TotalExcedenteContribuinte)</td>
                    </tr>
                    <tr>
                        <th>Venda Conforme Inciso I e II <br /> (@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.Faturamento)) %)</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.LimiteNcm)</td>
                        <th style="font-size:17px;text-align:center">-</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.BaseCalcNcm)</td>
                        <th style="font-size:17px;text-align:center">=</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.ExcedenteNcm)</td>
                        <th style="text-align:center">x</th>
                        <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.FaturamentoExcedente)) %</td>
                        <th style="font-size:17px;text-align:center">=</th>
                        <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.TotalExcedenteNcm)</td>
                    </tr>
                }


                </tr>
            }

        <tr>
            <th style="width:200px;">&nbsp;</th>
            <th style="width:120px;">&nbsp;</th>
            <th>&nbsp;</th>
            <th style="width:120px;">&nbsp;</th>
            <th></th>
            <th style="width:100px;">&nbsp;</th>
            <th>&nbsp;</th>
            <th style="width:100px;">&nbsp;</th>
            <th></th>
            <th style="width:100px;">&nbsp;</th>
        </tr>
        <tr>
            <th style="width:200px;"></th>
            <th style="width:120px;">Base de Cálculo</th>
            <th></th>
            <th style="width:120px;"></th>
            <th></th>
            <th style="width:100px;"></th>
            <th></th>
            <th style="width:100px;">Adicional</th>
            <th></th>
            <th style="width:100px;">Total</th>
        </tr>
        <tr>
        <tr>
            <th>Suspensão</th>
            <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.BaseCalcSuspensao)</td>
            <th></th>
            <td></td>
            <th></th>
            <td></td>
            <th style="text-align:center">x</th>
            <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.Company.Suspension)) %</td>
            <th style="font-size: 17px; text-align:center;">=</th>
            <td style="text-align:right; padding-right:1%;">@string.Format("{0:N}", ViewBag.TotalSuspensao)</td>
        </tr>
    </tbody>
</table>
