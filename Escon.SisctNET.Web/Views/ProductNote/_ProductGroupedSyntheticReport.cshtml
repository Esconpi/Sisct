@model IEnumerable<Escon.SisctNET.Model.ProductNote>

@if (ViewBag.TypeTaxation == "ST" || ViewBag.TypeTaxation == "AT")
{
    <thead>
        <tr style="border:1px solid;">
            <th></th>
            <th>Nota</th>
            <th>Fornecedor</th>
            <th>UF</th>
            <th>Dia/Mês</th>
            <th>V. Nota</th>
            <th>V. Produtos</th>
            <th>Frete Nº</th>
            <th>V. Frete</th>
            <th>Total BC</th>
            <th>BC ICMS</th>
            @if (ViewBag.TypeTaxation == "ST")
            {
                <th>BCR</th>
            }
            <th>V. Imp. AC</th>
            <th>ICMS</th>
            <th>ICMS ST NFe</th>
            <th>Fecop ST NFe</th>
            <th>Total ICMS</th>
            <th>Total Fecop</th>
        </tr>
    </thead>
    @for (int i = 0; i < ViewBag.NotasTaxation.Count; i++)
    {
        <tbody style="border:1px solid;">
            <tr>
                @if (ViewBag.NotasTaxation[i][19] == "")
                {
                    <td><strong>S</strong></td>
                }
                else
                {
                    <td><strong>I</strong></td>
                }
                <td>@ViewBag.NotasTaxation[i][0]</td>
                <td>@ViewBag.NotasTaxation[i][1]</td>
                <td>@ViewBag.NotasTaxation[i][17]</td>
                <td>@ViewBag.NotasTaxation[i][2]</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][3].Replace(".", ",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][4].Replace(".", ",")))</td>
                <td>@ViewBag.NotasTaxation[i][5]</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][6].Replace(".", ",")))</td>
                <td>
                    @string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][4].Replace(".", ",")) + Convert.ToDecimal(ViewBag.NotasTaxation[i][6].Replace(".", ",")) +
                                        Convert.ToDecimal(ViewBag.NotasTaxation[i][7].Replace(".", ",")))
                </td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][8].Replace(".", ",")))</td>
                @if (ViewBag.TypeTaxation == "ST")
                {
                    <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][9].Replace(".", ",")))</td>
                }
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][10].Replace(".", ",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][11].Replace(".", ",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][13].Replace(".", ",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][18].Replace(".", ",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][14].Replace(".", ",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][15].Replace(".", ",")))</td>
            </tr>
    </tbody>
}
}
else if (ViewBag.TypeTaxation == "AP" || ViewBag.TypeTaxation == "CO" ||
    ViewBag.TypeTaxation == "COR" || ViewBag.TypeTaxation == "IM")
{
    <thead>
        <tr style="border:1px solid;">
            <th></th>
            <th>Nota</th>
            <th>Fornecedor</th>
            <th>UF</th>
            <th>Dia/Mês</th>
            <th>V. Nota</th>
            <th>V. Produtos</th>
            <th>Frete Nº</th>
            <th>V. Frete</th>
            <th>BC ICMS</th>
            <th>ICMS ST NFe</th>
            <th>ICMS Apurado</th>

        </tr>
    </thead>

    @for (int i = 0; i < ViewBag.NotasTaxation.Count; i++)
    {
        <tbody style="border:1px solid;">
            <tr style="font-size:11px; border:1px solid;">
                @if (ViewBag.NotasTaxation[i][19] == "")
                {
                    <td><strong>S</strong></td>
                }
                else
                {
                    <td><strong>I</strong></td>
                }
                <td>@ViewBag.NotasTaxation[i][0]</td>
                <td>@ViewBag.NotasTaxation[i][1]</td>
                <td>@ViewBag.NotasTaxation[i][17]</td>
                <td>@ViewBag.NotasTaxation[i][2]</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][3].Replace(".",",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][4].Replace(".", ",")))</td>
                <td>@ViewBag.NotasTaxation[i][5]</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][6].Replace(".", ",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][4].Replace(".", ",")) + Convert.ToDecimal(ViewBag.NotasTaxation[i][6].Replace(".", ",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][13].Replace(".", ",")) + Convert.ToDecimal(ViewBag.NotasTaxation[i][18].Replace(".", ",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][16].Replace(".", ",")))</td>
            </tr>
        </tbody>
    }

}
else if (ViewBag.TypeTaxation == "Isento" || ViewBag.TypeTaxation == "NT")
{
    <thead>
        <tr style="border:1px solid;">
            <th></th>
            <th>Nota</th>
            <th>Fornecedor</th>
            <th>UF</th>
            <th>Dia/Mês</th>
            <th>V. Nota</th>
            <th>V. Produtos</th>


        </tr>
    </thead>

    @for (int i = 0; i < ViewBag.NotasTaxation.Count; i++)
    {
        <tbody style="border:1px solid;">
            <tr style="font-size:11px; border:1px solid;">
                @if (ViewBag.NotasTaxation[i][19] == "")
                {
                    <td><strong>S</strong></td>
                }
                else
                {
                    <td><strong>I</strong></td>
                }
                <td>@ViewBag.NotasTaxation[i][0]</td>
                <td>@ViewBag.NotasTaxation[i][1]</td>
                <td>@ViewBag.NotasTaxation[i][17]</td>
                <td>@ViewBag.NotasTaxation[i][2]</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][3].Replace(".", ",")))</td>
                <td>@string.Format("{0:N}", Convert.ToDecimal(ViewBag.NotasTaxation[i][4].Replace(".", ",")))</td>
            </tr>
        </tbody>
    }
}
