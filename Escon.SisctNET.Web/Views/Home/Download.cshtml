@model Escon.SisctNET.Model.Company

@{
    ViewData["Title"] = "Download";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="box box-primary">
    <div class="box-header">
        <div style="width:100%; overflow:hidden; padding:20px;">
            <div class="row">
                <div class="col-lg-12">
                    <img src="~/img/logo-sisct.png" style="width:25%; height:60%; float:left;" />
                    <img src="~/img/escon.png" style="width:20%; height:50%; float:right;" />
                </div>
            </div>

        </div>

        <div style="text-align:center;">
            <strong>@ViewBag.SocialName - @ViewBag.Document</strong>
        </div>

        <div style="width:100%; overflow:hidden; padding:20px;">
            <div class="row">
                <div class="col-lg-12">
                    <div class="form-group col-lg-6 col-md-6 col-xs-12">
                        <strong>Correção Sped</strong>
                    </div>
                    <div class="form-group col-lg-6 col-md-6 col-xs-12" style="text-align:right;">
                        <strong>Periodo: @ViewBag.Month/@ViewBag.Year </strong>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="box-body">
        <div style="width:100%; padding:20px;">
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>N° Nota</th>
                        <th>Valor Nota</th>
                        <th>N° Item</th>
                        <th>Código Produto</th>
                        <th>Descrição Produto</th>
                        <th>Valor Produto Original</th>
                        <th>Valor Produto Corrigido</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var p in SessionManager.GetProductsSped())
                    {
                        @if (Convert.ToDecimal(p[8]) > 0)
                        {
                            <tr style="border-left:5px solid; border-color:red;">
                                <td>@p[0]</td>
                                <td>@p[2]</td>
                                <td>@p[3]</td>
                                <td>@p[4]</td>
                                <td>@p[5]</td>
                                <td>@string.Format("{0:N}", Convert.ToDecimal(p[6]))</td>
                                <td>@string.Format("{0:N}", Convert.ToDecimal(p[7]))</td>
                            </tr>
                        }
                        else
                        {
                            <tr style="border-left:5px solid; border-color:green;">
                                <td>@p[0]</td>
                                <td>@p[2]</td>
                                <td>@p[3]</td>
                                <td>@p[4]</td>
                                <td>@p[5]</td>
                                <td>@string.Format("{0:N}", Convert.ToDecimal(p[6]))</td>
                                <td>@string.Format("{0:N}", Convert.ToDecimal(p[7]))</td>
                            </tr>
                        }

                    }
                </tbody>
            </table>
        </div>
        <div class="no-print" style="text-align:center">
            <a asp-controller="Home" asp-action="DownloadSped" asp-route-id="@Model.Id" asp-route-year="@ViewBag.Year" asp-route-month="@ViewBag.Month"><i class="fa fa-cloud-download"></i> Fazer Download do Arquivo</a>
        </div>
    </div>
</div>
