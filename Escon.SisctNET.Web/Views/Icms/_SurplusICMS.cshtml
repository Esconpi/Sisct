<table class="table" style="font-size:12px; border:2px solid;">
    <thead>
        <tr>
            <th style="border:1px solid;">

            </th>
            <th style="text-align:center; border:1px solid;">
                Total
            </th>
            <th style="text-align:center; border:1px solid;">
                Devolução
            </th>
            <th style="text-align:center; border:1px solid;">
                Base de Cálculo
            </th>
            <th style="text-align:center; border:1px solid;">
                Percentual (%)
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th style="border: 1px solid; text-align:center;">
                Vendas
            </th>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalVenda)
            </td>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalDevo)
            </td>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.BaseCalc)
            </th>
            <th style="text-align:right; padding-right:1%; border:1px solid;"></th>
        </tr>
        <tr>
            <th style="border: 1px solid; text-align:center;">
                Vendas P/ Contribuintes
            </th>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.Contribuinte)
            </td>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalDevoContrib)
            </td>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.BaseCalcContrib)
            </th>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.PercentualVendaContribuinte) %
            </th>
        </tr>
        <tr>
            <th style="border: 1px solid; text-align:center;">
                Vendas P/ Não Contribuintes
            </th>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.NContribuinte)
            </td>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalDevoNContrib)
            </td>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.BaseCalcNContrib)
            </th>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.PercentualVendaNContribuinte) %
            </th>
        </tr>
        <tr>
            <th style="border: 1px solid; text-align:center;">
                Vendas do Anexo II
            </th>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.VendaAnexo)
            </td>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalDevoAnexo)
            </td>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.BaseCalcAnexo)
            </th>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.PercentualVendaAnexo) %
            </th>
        </tr>
        <tr>
            <th style="border: 1px solid; text-align:center;">
                Vendas P/ mesmo grupo maior que @ViewBag.PercentualCNPJ %
            </th>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalVendaGrupo)
            </td>
            <td style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalDevoGrupo)
            </td>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.TotalBaseCalcuGrupo)
            </th>
            <th style="text-align:right; padding-right:1%; border:1px solid;">
                @string.Format("{0:N}", ViewBag.PercentualVendaGrupo) %
            </th>
        </tr>
    </tbody>
</table>

@if (ViewBag.Grupo.Count > 0)
{
    <table class="table" style="font-size: 12px;">
        <thead>
            <tr style="border: 1px solid;">
                <th style="border: 1px solid; text-align:center;">CNPJ</th>
                <th style="border: 1px solid; text-align:center;">Cliente</th>
                <th style="border: 1px solid;">Base de Cálculo</th>
                <th style="border: 1px solid;">Percentual (%)</th>
            </tr>
        </thead>
        <tbody>

            @foreach (var item in ViewBag.Grupo)
            {
                <tr>
                    <td>@item[0]</td>
                    <td>@item[1]</td>
                    <td>@string.Format("{0:N}", item[2])</td>
                    <td>@string.Format("{0:N}", item[3]) %</td>
                    
                </tr>
            }

        </tbody>
    </table>
}


<table class="table" style="font-size: 12px; page-break-before: always;">
    <thead>
        <tr>
            <th>
                <table class="table">
                    <thead class="table">
                        <tr class="table" style="border: 1px solid;">
                            <th style="text-align:center; border: 1px solid;">APURAÇÃO ICMS</th>
                        </tr>
                    </thead>
                </table>
            </th>
        </tr>
    </thead>

    <tbody>
        <tr>
            <td>
                <table class="table">
                    <thead>
                        <tr>
                            <th style="width:200px;"></th>
                            <th style="width:120px;">Vendas</th>
                            <th></th>
                            <th style="width:120px;">Limite (MÁXIMO)</th>
                            <th></th>
                            <th style="width:100px;">Excedente</th>
                            <th></th>
                            <th style="width:100px;">Adicional</th>
                            <th></th>
                            <th style="width:100px;">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>ICMS Excedente Grupo</th>
                            <td>
                                @string.Format("{0:N}", ViewBag.TotalBaseCalcuGrupo)
                            </td>
                            <th style="font-size:17px">-</th>
                            <td>@string.Format("{0:N}", ViewBag.LimiteGrupo)</td>
                            <th style="font-size:17px">=</th>
                            <td>@string.Format("{0:N}", ViewBag.ExcedenteGrupo)</td>
                            <th>x</th>
                            <td>@string.Format("{0:N}", ViewBag.PercentualExcedenteGrupo) %</td>
                            <th style="font-size:17px">=</th>
                            <td>@string.Format("{0:N}", ViewBag.TotalExcedenteGrupo)</td>
                        </tr>
                        <tr>
                            <th>Transferência Interestadual</th>
                            <td>@string.Format("{0:N}", ViewBag.TotalTransferencia)</td>
                            <th style="font-size:17px">-</th>
                            <td>@string.Format("{0:N}", ViewBag.LimiteTransferencia)</td>
                            <th style="font-size:17px">=</th>
                            <td>@string.Format("{0:N}", ViewBag.ExcedenteTransferencia)</td>
                            <th>x</th>
                            <td>@string.Format("{0:N}", ViewBag.PercentaulTransferencia) %</td>
                            <th style="font-size:17px">=</th>
                            <td>@string.Format("{0:N}", ViewBag.TotalExcedenteTransferencia)</td>
                        </tr>
                        <tr>
                            <th>ICMS Excedente P/ Não Contribuinte</th>
                            <td>@string.Format("{0:N}", ViewBag.BaseCalcNContrib)</td>
                            <th style="font-size:17px">-</th>
                            <td>@string.Format("{0:N}", ViewBag.LimiteNContribuinte)</td>
                            <th style="font-size:17px">=</th>
                            <td>@string.Format("{0:N}", ViewBag.ExcedenteNContribuinte)</td>
                            <th>x</th>
                            <td>@string.Format("{0:N}", ViewBag.PercentualExcedenteNContribuinte) %</td>
                            <th style="font-size:17px">=</th>
                            <td>@string.Format("{0:N}", ViewBag.TotalExcedenteNContribuinte)</td>
                        </tr>
                    </tbody>

                </table>
            </td>
        </tr>

        <tr>
            <td>
                <table class="table">
                    <thead>
                      
                        <tr>
                            <th style="width:200px;"></th>
                            <th style="width:120px;">Limite (MÍNIMO)</th>
                            <th></th>
                            <th style="width:120px;">Vendas</th>
                            <th></th>
                            <th style="width:100px;">Excedente</th>
                            <th></th>
                            <th style="width:100px;">Adicional</th>
                            <th></th>
                            <th style="width:100px;">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>Venda Conforme Anexo</th>
                            <td> @string.Format("{0:N}", ViewBag.LimiteAnexo)</td>
                            <th style="font-size:17px">-</th>
                            <td>@string.Format("{0:N}", ViewBag.BaseCalcAnexo)</td>
                            <th style="font-size:17px">=</th>
                            <td>@string.Format("{0:N}", ViewBag.ExcedenteAnexo)</td>
                            <th>x</th>
                            <td>@string.Format("{0:N}", ViewBag.PercentualExcedenteAnexo) %</td>
                            <th style="font-size:17px">=</th>
                            <td>@string.Format("{0:N}", ViewBag.TotalExcedenteAnexo)</td>
                        </tr>
                    </tbody>

                </table>
            </td>
        </tr>
        <tr>
            <td>
                <table class="table">
                    <thead>
                        <tr>
                            <th style="width:200px;"></th>
                            <th style="width:120px;">Base de Cálculo</th>
                            <th></th>
                            <th style="width:120px;"></th>
                            <th></th>
                            <th style="width:100px;"></th>
                            <th></th>
                            <th style="width:100px;">Adicional</th>
                            <th></th>
                            <th style="width:100px;">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>Suspensão</th>
                            <td>@string.Format("{0:N}", ViewBag.BaseCalcSuspensao)</td>
                            <th></th>
                            <td></td>
                            <th></th>
                            <td></td>
                            <th>x</th>
                            <td>@string.Format("{0:N}", ViewBag.PercentaulSuspensao) %</td>
                            <th style="font-size:17px">=</th>
                            <td>@string.Format("{0:N}", ViewBag.TotalSuspensao)</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <th>Total ICMS</th>
                            <td></td>
                            <th>@string.Format("{0:N}", ViewBag.TotalIcms)</th>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <th>DAR</th>
                            <td></td>
                            <th>@ViewBag.DarIcms</th>
                        </tr>
                    </tfoot>
                </table>
            </td>
        </tr>
    </tbody>
</table>
