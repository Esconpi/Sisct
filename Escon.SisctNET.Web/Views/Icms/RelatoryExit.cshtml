@{
    ViewData["Title"] = "RelatoryExit";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

    <div class="box box-primary">
        <div class="box-header">
            <div style="width:100%; overflow:hidden; padding:20px;">
                <div class="row">
                    <div class="col-lg-12">
                        <img src="~/img/logo-sisct.png" style="width:25%; height:60%; float:left;" />
                        <img src="~/img/escon.png" style="width:20%; height:50%; float:right;" />
                    </div>
                </div>

            </div>

            <div style="text-align:center;">
                <strong>@ViewBag.SocialName - @ViewBag.Document</strong>
            </div>

            <div style="width:100%; overflow:hidden; padding:20px;">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="form-group col-lg-6 col-md-6 col-xs-12">
                            @if (ViewBag.Type == "resumocfop")
                            {
                                <strong>Resumo por CFOP</strong>
                            }
                            else if (ViewBag.Type == "venda")
                            {
                                <strong>Relatório de Penalidade</strong>
                            }

                        </div>
                        <div class="form-group col-lg-6 col-md-6 col-xs-12" style="text-align:right;">
                            <strong>Periodo: @ViewBag.Month/@ViewBag.Year </strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="box-body">
            <div style="width:100%; overflow:hidden; padding:20px;">

                @if (ViewBag.Type == "resumocfop")
                {
                    <table class="table" style="border:1px solid;">
                        <thead>
                            <tr style="border:1px solid;">
                                <th style="border:1px solid;">
                                    CFOP
                                </th>
                                <th style="border:1px solid;">
                                    Descrição
                                </th>
                                <th style="border:1px solid;">
                                    Valor Contábil
                                </th>
                                <th style="border:1px solid;">
                                    Base de Cálculo Icms
                                </th>
                                <th style="border:1px solid;">
                                    Valor Icms
                                </th>
                                <th style="border:1px solid;">
                                    Valor Fecop
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (int i = 0; i < ViewBag.Cfop.Count; i++)
                            {

                                <tr style="border:1px solid;">
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][0]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][1]
                                    </td>
                                    <td style="border:1px solid;">
                                        <b>@ViewBag.Cfop[i][2]</b>
                                    </td>
                                    <td style="border:1px solid;">
                                        <b>@ViewBag.Cfop[i][3]</b>
                                    </td>
                                    <td style="border:1px solid;">
                                        <b>@ViewBag.Cfop[i][4]</b>
                                    </td>
                                    <td style="border:1px solid;">
                                        <b>@ViewBag.Cfop[i][5]</b>
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td style="border:1px solid;"><b>Venda com CPF</b></td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][6]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][7]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][8]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][9]
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td style="border:1px solid;"><b>Venda sem CPF</b></td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][10]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][11]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][12]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][13]
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td style="border:1px solid;"><b>Venda com CNPJ com Inscrição Estadual</b></td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][14]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][15]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][16]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][17]
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td style="border:1px solid;"><b>Venda com CNPJ sem Inscrição Estadual</b></td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][18]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][19]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][20]
                                    </td>
                                    <td style="border:1px solid;">
                                        @ViewBag.Cfop[i][21]
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else if (ViewBag.Type == "venda")
                {
                    <table class="table" style="font-size:10px;">
                        <thead>
                            <tr>
                                <th>

                                </th>
                                <th>
                                    Valor
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>
                                    Base de Cálculo
                                </th>
                                <td>
                                    @ViewBag.TotalSaida
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    Vendas P/ Contribuintes
                                </th>
                                <td>
                                    @ViewBag.Contribuinte
                                </td>
                            </tr>

                            <tr>
                                <th>
                                    Vendas P/ Não Contribuintes
                                </th>
                                <td>
                                    @ViewBag.NContribuinte
                                </td>
                            </tr>

                            <tr>
                                <th>
                                    Vendas P/ CNPJ maior que @ViewBag.PercentualCNPJ %
                                </th>
                                <td>
                                    @ViewBag.TotalExecedente
                                </td>
                            </tr>

                            <tr>
                                <th>
                                    Vendas do Anexo II
                                </th>
                                <td>
                                    @ViewBag.VendaAnexo
                                </td>
                            </tr>

                        </tbody>
                    </table>

                    @if (ViewBag.Grupo.Count == 0)
                    {
                        <h6 style="padding-left:20px;"><strong>Não houve vendas para contribuites maior que @ViewBag.PercentualCNPJ %</strong></h6>
                    }
                    else
                    {
                        <table class="table" style="font-size: 10px;">
                            <thead>
                                <tr style="border: 1px solid;">
                                    <th style="border: 1px solid; text-align:center;">CNPJ</th>
                                    <th style="border: 1px solid; text-align:center;">Cliente</th>
                                    <th style="border: 1px solid;">Percentual</th>
                                    <th style="border: 1px solid;">Valor</th>
                                </tr>
                            </thead>
                            <tbody>
                              
                                @foreach (var item in ViewBag.Grupo)
                                {
                                    <tr>
                                        <td>@item[0]</td>
                                        <td>@item[1]</td>
                                        <td>@item[2]</td>
                                        <td>@item[3]</td>
                                    </tr>
                                }

                            </tbody>
                        </table>
                    }


                    <table class="table" style="font-size: 10px;">
                        <thead>
                            <tr>
                                <th>
                                    <table class="table">
                                        <thead class="table">
                                            <tr class="table" style="border: 1px solid;">
                                                <th style="text-align:center; border: 1px solid;">APURAÇÃO ICMS</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr>
                                <td>
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th style="width:200px;"></th>
                                                <th style="width:120px;">Vendas</th>
                                                <th></th>
                                                <th style="width:120px;">Limite (MÁXIMO)</th>
                                                <th></th>
                                                <th style="width:100px;">Excedente</th>
                                                <th></th>
                                                <th style="width:100px;">Adicional</th>
                                                <th></th>
                                                <th style="width:100px;">Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in ViewBag.Grupo)
                                            {
                                                <tr>
                                                    <th>ICMS excedente</th>
                                                    <td>@item[3]</td>
                                                    <th>-</th>
                                                    <td>@item[4]</td>
                                                    <th>=</th>
                                                    <td>@item[5]</td>
                                                    <th>x</th>
                                                    <td>@item[6]</td>
                                                    <th>=</th>
                                                    <td>@item[7]</td>
                                                </tr>
                                            }
                                            <tr>
                                                <th>Transferência Interestadual</th>
                                                <td>@ViewBag.TotalTransferencia</td>
                                                <th>-</th>
                                                <td>@ViewBag.LimiteTransferencia</td>
                                                <th>=</th>
                                                <td>@ViewBag.ExcedenteTransferencia</td>
                                                <th>x</th>
                                                <td>@ViewBag.PercentaulTransferencia</td>
                                                <th>=</th>
                                                <td>@ViewBag.TotalExcedenteTransferencia</td>
                                            </tr>

                                        </tbody>

                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th style="width:200px;"></th>
                                                <th style="width:120px;">Limite (MÍNIMO)</th>
                                                <th></th>
                                                <th style="width:120px;">Vendas</th>
                                                <th></th>
                                                <th style="width:100px;">Excedente</th>
                                                <th></th>
                                                <th style="width:100px;">Adicional</th>
                                                <th></th>
                                                <th style="width:100px;">Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <th>ICMS excedente contribuinte</th>
                                                <td>@ViewBag.LimiteContribuinte</td>
                                                <th>-</th>
                                                <td>@ViewBag.Contribuinte</td>
                                                <th>=</th>
                                                <td>@ViewBag.ExcedenteContribuinte</td>
                                                <th>x</th>
                                                <td>@ViewBag.PercentualExcedenteContribuinte</td>
                                                <th>=</th>
                                                <td>@ViewBag.TotalExcedenteContribuinte</td>
                                            </tr>
                                            <tr>
                                                <th>Venda conforme anexo</th>
                                                <td>@ViewBag.LimiteAnexo</td>
                                                <th>-</th>
                                                <td>@ViewBag.VendaAnexo</td>
                                                <th>=</th>
                                                <td>@ViewBag.ExcedenteAnexo</td>
                                                <th>x</th>
                                                <td>@ViewBag.PercentualExcedenteAnexo</td>
                                                <th>=</th>
                                                <td>@ViewBag.TotalExcedenteAnexo</td>
                                            </tr>
                                            <tr>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <th>Total ICMS</th>
                                                <td></td>
                                                <td>@ViewBag.TotalIcms</td>
                                            </tr>
                                        </tbody>
                                        <tfoot>
                                            <tr>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <th>DAR</th>
                                                <td></td>
                                                <th>113000</th>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </td>
                            </tr>

                        </tbody>
                    </table>

                }

            </div>
        </div>
    </div>