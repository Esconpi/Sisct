@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="box box-primary">
    <div class="box-header">
        <div style="width:100%; overflow:hidden; padding:20px;">
            <div>
                <img src="~/img/logo-sisct.png" style="width:25%; height:60%; float:left;" />
                <img src="~/img/escon.png" style="width:20%; height:50%; float:right;" />
            </div>
        </div>

        <div style="text-align:center;">
            <strong>@ViewBag.SocialName - @ViewBag.Document</strong>
        </div>
        <div style="width:100%; overflow:hidden; padding:20px;">
            <div style="float:left;"><strong>Periodo:</strong> @ViewBag.Mes/@ViewBag.Ano</div>
            <div style="float:right;"><strong>Data:</strong> @DateTime.Now.ToString("dd/MM/yyyy")</div>
        </div>
    </div>
    <div class="box-body">
        <div style="width:100%;font-size:11px; padding:20px;">
            @if (ViewBag.opcao == "1")
            {
                @if (ViewBag.ordem == "1")
                {
                    <table class="table table-striped table-bordered" style="width:100%;font-size:10px;">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Modelo</th>
                                <th>Tipo</th>
                                <th>UF</th>
                                <th>Nota</th>
                                <th>CNPJ/CPF</th>
                                <th>Nome</th>
                                <th>Valor</th>
                                <th>Chave</th>
                            </tr>
                        </thead>
                        <tbody>

                            @for (int i = 0; i < ViewBag.Notas.Count; i++)
                            {
                                <tr>
                                    <td>@ViewBag.Notas[i][1]["dhEmi"]</td>
                                    <td>@ViewBag.Notas[i][1]["mod"]</td>
                                    <td>@ViewBag.Notas[i][1]["tpNF"]</td>
                                    <td>@ViewBag.Notas[i][2]["UF"]</td>
                                    <td>@ViewBag.Notas[i][1]["nNF"]</td>
                                    @if (ViewBag.Notas[i][2].ContainsKey("CNPJ"))
                                    {
                                        <td>@ViewBag.Notas[i][2]["CNPJ"]</td>
                                    }
                                    else
                                    {
                                        <td>@ViewBag.Notas[i][2]["CPF"]</td>
                                    }
                                    <td>@ViewBag.Notas[i][2]["xNome"]</td>
                                    <td>@ViewBag.Notas[i][4]["vNF"]</td>
                                    <td>@ViewBag.Notas[i][0]["chave"]</td>
                                </tr>
                            }
                        </tbody>
                    </table>

                }
                else if (ViewBag.ordem == "2")
                {
                    <table class="table table-striped table-bordered" style="width:100%;font-size:10px;">
                        <thead>
                            <tr>
                                <th>Chave</th>
                                <th>Modelo</th>
                                <th>Número</th>
                                <th>Valor</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var nota in ViewBag.notas_sped)
                            {
                                <tr>
                                    <th>@nota[0]</th>
                                    <th>@nota[1]</th>
                                    <th>@nota[2]</th>
                                    <th>@nota[3]</th>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else if (ViewBag.ordem == "3")
                {
                    <table class="table table-striped table-bordered" style="width:100%;font-size:10px;">
                        <thead>
                            <tr>
                                <th>Nº NFe</th>
                                <th>Fornecedor</th>
                                <th>Total NFe</th>
                                <th>Total Sped</th>
                                <th>DIF</th>
                                <th>Desconto NFe</th>
                                <th>Desconto Sped</th>
                                <th>DIF</th>
                                <th>Outras Despesas NFe</th>
                                <th>Outras Despesas Sped</th>
                                <th>DIF</th>
                                <th>Frete NFe</th>
                                <th>Frete Sped</th>
                                <th>DIF</th>
                                <th>Seguro NFe</th>
                                <th>Seguro Sped</th>
                                <th>DIF</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var valor in ViewBag.Valores)
                            {
                                <tr>
                                    <td>@valor[0]</td>
                                    <td>@valor[1]</td>
                                    <td style="text-align:right;">@valor[2]</td>
                                    <td style="text-align:right;">@valor[3]</td>
                                    <td style="background-color:lightgray; text-align:right;">@valor[4]</td>
                                    <td style="text-align:right;">@valor[5]</td>
                                    <td style="text-align:right;">@valor[6]</td>
                                    <td style="background-color:lightgray; text-align:right;">@valor[7]</td>
                                    <td style="text-align:right;">@valor[8]</td>
                                    <td style="text-align:right;">@valor[9]</td>
                                    <td style="background-color:lightgray; text-align:right;">@valor[10]</td>
                                    <td style="text-align:right;">@valor[11]</td>
                                    <td style="text-align:right;">@valor[12]</td>
                                    <td style="background-color:lightgray; text-align:right;">@valor[13]</td>
                                    <td style="text-align:right;">@valor[14]</td>
                                    <td style="text-align:right;">@valor[15]</td>
                                    <td style="background-color:lightgray; text-align:right;">@valor[16]</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else if (ViewBag.ordem == "4")
                {
                    <table class="table table-striped table-bordered" style="width:100%;font-size:12px;">
                        <thead>
                            <tr>
                                <th>Nº NFe</th>
                                <th>Fornecedor</th>
                                <th>Total NFe</th>
                                <th>Total Sped</th>
                                <th>DIFERENÇA</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var valor in ViewBag.Valores)
                            {
                                <tr>
                                    <td>@valor[0]</td>
                                    <td>@valor[1]</td>
                                    <td style="text-align:right;">@valor[2]</td>
                                    <td style="text-align:right">@valor[3]</td>
                                    <td style="background-color:lightgray;text-align:right;">@valor[4]</td>
                                </tr>
                            }
                        </tbody>
                        <tbody>
                            <tr>
                                <td><strong>Total</strong></td>
                                <td></td>
                                <td style="text-align:right;"><strong>@ViewBag.TotalXml</strong></td>
                                <td style="text-align:right;"><strong>@ViewBag.TotalSped</strong></td>
                                <td style="background-color:lightgray; text-align:right;"><strong>@ViewBag.TotalDif </strong></td>
                            </tr>
                        </tbody>
                    </table>
                }
                <div style="float:left;">
                    <h6>
                        <strong>
                            @if (ViewBag.ordem == "2")
                            {
                                @ViewBag.notas_sped.Count
                            }
                            else if (ViewBag.ordem == "1")
                            {
                                @ViewBag.Notas.Count
                            }
                            else if (ViewBag.ordem == "3" || ViewBag.ordem == "4")
                            {
                                @ViewBag.Valores.Count
                            }
                            registro(s)
                        </strong>
                    </h6>
                </div>
            }
            else if (ViewBag.opcao == "2")
            {
                <table class="table table-striped table-bordered" style="width:100%;font-size:11px;">
                    <thead>
                        <tr>
                            <th>
                                Data
                            </th>
                            <th>
                                Modal
                            </th>
                            <th>
                                Tipo
                            </th>
                            <th>
                                UF
                            </th>
                            <th>
                                Nota
                            </th>
                            <th>
                                CNPJ
                            </th>
                            <th>
                                Nome
                            </th>
                            <th>
                                Valor
                            </th>
                            <th>
                                Chave
                            </th>
                        </tr>
                    </thead>
                    <tbody>

                        @for (int i = 0; i < ViewBag.Ctes.Count; i++)
                        {
                            <tr>
                                <td>
                                    @ViewBag.Ctes[i][1]["dhEmi"]
                                </td>
                                <td>
                                    @if (ViewBag.Ctes[i][1]["modal"] == "01")
                                    {
                                        @ViewBag.Modal[0]
                                    }
                                    else if (ViewBag.Ctes[i][1]["modal"] == "02")
                                    {
                                        @ViewBag.Modal[1]
                                    }
                                    else if (ViewBag.Ctes[i][1]["modal"] == "03")
                                    {
                                        @ViewBag.Modal[2]
                                    }
                                    else if (ViewBag.Ctes[i][1]["modal"] == "04")
                                    {
                                        @ViewBag.Modal[3]
                                    }
                                    else if (ViewBag.Ctes[i][1]["modal"] == "05")
                                    {
                                        @ViewBag.Modal[4]
                                    }
                                    else if (ViewBag.Ctes[i][1]["modal"] == "06")
                                    {
                                        @ViewBag.Modal[5]
                                    }
                                </td>
                                <td>
                                    @if (ViewBag.Ctes[i][1]["tpServ"] == "0")
                                    {
                                        @ViewBag.Tipos[0]
                                    }
                                    else if (ViewBag.Ctes[i][1]["tpServ"] == "1")
                                    {
                                        @ViewBag.Tipos[1]
                                    }
                                    else if (ViewBag.Ctes[i][1]["tpServ"] == "2")
                                    {
                                        @ViewBag.Tipos[2]
                                    }
                                    else if (ViewBag.Ctes[i][1]["tpServ"] == "3")
                                    {
                                        @ViewBag.Tipos[3]
                                    }
                                    else if (ViewBag.Ctes[i][1]["tpServ"] == "4")
                                    {
                                        @ViewBag.Tipos[4]
                                    }
                                </td>
                                <td>
                                    @ViewBag.Ctes[i][3]["UF"]
                                </td>
                                <td>
                                    @ViewBag.Ctes[i][1]["nCT"]
                                </td>
                                <td>
                                    @ViewBag.Ctes[i][3]["CNPJ"]
                                </td>
                                <td>
                                    @ViewBag.Ctes[i][3]["xNome"]
                                </td>
                                <td>
                                    @ViewBag.Ctes[i][4]["vTPrest"]
                                </td>
                                <td>
                                    @ViewBag.Ctes[i][0]["chave"]
                                </td>
                            </tr>
                        }

                    </tbody>
                </table>
                <div style="float:left;">
                    <h6><strong>@ViewBag.Ctes.Count registro(s)</strong></h6>
                </div>
            }

        </div>
    </div>
    <div class="box-footer"></div>
</div>