
<style>
    .table {
        margin-bottom: 5px;
    }

        .table > thead > tr > th {
            border-bottom: 2px solid;
        }

        .table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td, .table > tbody > tr > td, .table > tfoot > tr > td {
            border: 1px solid;
            line-height: 0.2;
            padding: 5px;
        }
</style>

@if (ViewBag.Ncms.Count > 0)
{
    <table class="table" style="font-size:12px; border:1px solid">
        @foreach (var ncm in ViewBag.Ncms)
        {

            <thead>
                <tr>
                    <th style="border: 1px solid; text-align: center; width:60%;">
                        NCM
                    </th>
                    <th style="border: 1px solid; text-align: center;" width="20%">
                        XML
                    </th>
                    <th style="border: 1px solid; text-align: center;" width="20%">
                        SisCT
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr style="border:1px solid;">
                    <td style="border:1px solid; padding-left:1%;">
                        @if (ncm[1].Length > 100)
                        {
                            @ncm[1].Substring(0, 100)
                        }
                        else
                        {
                            @ncm[1]
                        }

                    </td>
                    <td style="border: 1px solid; padding-left: 1%; text-transform: uppercase;">
                        @ncm[2]
                    </td>
                    <td style="border: 1px solid; padding-left: 1%; text-transform: uppercase;">
                        @ncm[3]
                    </td>
                </tr>


                <tr>
                    <th style="border: 1px solid; text-align: center;" colspan="2">PRODUTO</th>
                    <th style="border: 1px solid; text-align: center;" colspan="1">NOTA</th>
                </tr>

                @foreach (var prod in ViewBag.Produtos)
                {
                    @if (ncm[0] == prod[0])
                    {
                        <tr>
                            <td style="border:1px solid; padding-left:1%;" colspan="2">
                                @prod[1] - @prod[2]
                            </td>
                            <td style="border:1px solid; padding-left:1%;" colspan="1">
                                @prod[3]
                            </td>
                        </tr>
                    }

                }
            </tbody>

        }
    </table>
}
else
{
    <p style="text-align:center; color:green;">Não há NCM divergente</p>
}